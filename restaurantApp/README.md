## Система управления заказами в ресторане
Данное консольное приложение на Kotlin, которое предоставляет ряд функций для сотрудника ресторана и посетителя.<br />
Сотрудник ресторана может управлять меню ресторана, собирать статистику о заказах и отзывах.<br />
Посетитель же может оформить заказ, выбрав определенное количество блюд из меню, с возможностью редактирования и отмены заказа.

## Аутентификация

Перед тем как приступить к работе сотрудник должен войти в свой аккаунт. <br />
Для получения доступа к функционалу посетителя или администратора, пользователю нужно войти в уже существующий аккаунт по средствам ввода логина и пароля 
или создать новый.

При запуске программы доступно консольное меню из пунктов:

Continue as:
1. Visitor
2. Admin
3. Exit


Пользователь вводит номер пункта, после чего может приступить к процессу аутентификации, в которых входит ввод пароля и логина.<br />
При этом для посетителя имеется дополнительное меню для выбора между регистрацией и авторизацией

Login with current account or sign in:
1. Login into account
2. Sign in new account

Программа предупредит пользователя в случае неверного ввода пароля или попытки регистрации по уже существующему логину
При этом в случае регистрации нового аккаунта администратора требуется ввести кодовое слово `admin`

Все данные об администраторах и посетителях хранятся в файле `userLoginData.csv` в формате:
```
Role,ID,Login,Password,MoneyAmount
Admin,UUID,adminName,hashedPassword
Visitor,UUID,visitorName,hashedPassword,0
```
В строке сначала идет роль пользователя, после чего строка типа UUID содержащая в себе уникальный идентификатор, логин пользователя, хэшированный пароль.<br />
Также для пользователей с ролью `Visitor` хранится текущее количество денежных средств.

## Функционал администратора

После успешной аутентификации администратору предоставляется следующее меню функций:
```
Admin. Choose an option:
1. Show information about dishes
2. Add dish
3. Change dish
4. Delete dish
5. Check income
6. Get statistic
7. Exit.
```

<b> 1. Информация о блюдах </b>

При вызове данной функции программа покажет все блюда, который находятся в меню на данный момент, в формате:
```
"dishName,dishAmount,dishPrice,dishDifficulty"
```
Где `dishName` - название блюда, `dishAmount` - текущее количество блюда, `dishPrice` - стоимость блюда и `dishDifficulty` - время (в секундах) которое блюдо будет готовиться.

<b> 2. Добавить блюдо </b>

Данная функция позволяет администратору добавить блюдо в меню указав поочередно параметры, указанные в пункте выше.
```
Input the name of the dish: 
Input amount of dish: 
Input the price of the dish: 
Input the cooking time of the dish: (in seconds)
```

<b> 3. Изменить блюдо </b>

Данная функция позволяет администратору изменить уже существующее блюдо путем изменения одного из параметров:

- Цена блюда
- Стоимость блюда
- Сложность блюда

Все новые значения должны быть положительными.

<b> 4. Удалить блюдо </b>

Функция позволяет удалить блюдо из меню, все заказанные до удаления блюда этого типа сохраняются.
```
Choose dish to delete
1 Miso Soup with amount 2, price 500 and difficulty 10
2 Falafel Wrap with amount 1, price 150 and difficulty 15
```
Для удаления администратор должен ввести номер блюда, которое он хочет удалить

<b> 5. Проверить заработок </b>

Функция выводит текущий заработок ресторана. Суммой заработка является суммой цен всех блюд, которые посетитель **оплатил**.

<b> 6. Получение статистики </b>

Администратор может получить статистику о трех видах данных:

- Количество заказов
- Средний рейтинг заказов
- Самое популярное блюдо
Меню для выбора статистики:
```
What type of statistic you want?
1. The number of orders
2. Average order rating
3. Most popular dish
4. Exit
```

## Функционал посетителя

После успешной аутентификации посетителю предоставляется следующее меню функций:
```
Choose as option:
1. Make order.
2. Change order.
3. Cancel order.
4. Check orders.
5. Pay for the order.
6. Fill your wallet.
7. Exit.
```
<b> 1. Сделать заказ </b>
Если пользователь хочет сделать заказ, ему предоставляется меню, которое позволяет добавлять блюда в свой заказ.

```
Make your order:
   1. Add dish to order
   2. Finish order
   3. Exit
```
Первый пункт `Add dish to order` позволяет выбрать блюдо из текущего меню.
```
List of all available dishes:
1. Miso Soup with amount of 2. Price: 500
2. Falafel Wrap with amount of 10. Price: 150
```
Пользователь вводит номер пункта с блюдом, которое он хочет заказать. Если пользователь захочет добавить в заказ блюдо, которое закончилось, то получит предупреждение, что добавить блюдо в заказ нельзя.

Как только все желаемые блюда были добавлены пользователь может выбрать второй пункт создания заказа и отправить заказ на приготовление.<br />
Пользователь также может выйти из меню создания заказа и вернуться к его формирования позже, благодаря функции изменения заказа.

<b> 2. Изменить заказ </b>

При выборе данного пункта посетитель получает список всех заказов, которые имеют статус "Создание" или "В процессе"<br />
Пользователь может выбрать заказ и дополнить его / завершить, отправив на приготовление

<b> 3. Отменить заказ </b>

Посетитель может отменить заказ, выбрав заказ из списка еще не готовых заказов, то есть тех, что имеют статус "Создание" или "В процессе"<br />

<b> 4. Проверить заказы </b>

При выборе данного пункта посетитель получает все заказы с указанным статусом:

- Creating - заказ на стадии формирования
- In process... - заказ на стадии приготовления
- Finished - заказ готов
При этом как только готовый заказ будет оплачен, он будет удален из списка

<b> 5. Оплатить заказ </b>

Пользователю предоставляется список всех заказов, которые были приготовлены, с указанием цены <br />
Для оплаты нужно указать номер пункта с заказом, который посетитель хочет оплатить.
В случае если у пользователя недостаточно средств, программа сообщит ему об этом и не даст провести оплату.

<b> 6. Пополнить кошелек </b>

Посетитель может указать сумму, на которую он хочет пополнить кошелек. Сумма не может превышать 100тыс.

## Система приоритетов для обработки заказов

Заказы обрабатываются (приготавливаются) в порядке их поступления, то есть когда посетитель выбрал пункт `Finish order` <br />
В случае изменение заказа в момент приготовления, текущее время до готовности будет остановлена, пока заказ не будет изменен и подтвержден <br />
Количество заказов, которые могут готовиться одновременно - неограниченно

## Шаблоны проектирования

В данной программе используется такие шаблоны проектирования как

- Команда
- Строитель

<b> Команда </b>

Так как приложение ориентировано на предоставление множества функций для разных групп пользователь было принято решение использовать паттерн команда.<br />
Данный паттерн позволяет структурировать вызов функций путем создания объекта Invoker, которых хранит в себе словарь со всеми командами.<br />
Таким образом для уменьшения дублирования кода и его структурирования мы используем данный паттерн.<br />
Во избежание получения одному типу пользователя доступа к командам другого перед отправкой команды к полю `request` добавляется специальная строка-маркер.

<b> Строитель </b>

Так как мы работаем с несколькими классами, которые частично отличаются по своей структуре, мы можем использовать паттерн строитель. <br />
Он поможет нам изолировать код сборки продукта от его основной логики, вынеся такие вещи как хэширования в логику самого билдера



